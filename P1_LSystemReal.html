<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<title>Project1LSystem</title>
	<meta name="generator" content="BBEdit 11.1" />
	<link href="libraries/jquery-ui-1.11.4.custom/jquery-ui.css" rel="stylesheet">
	<link href="libraries/jquery-ui-1.11.4.custom/jquery-ui.css" rel="stylesheet">
	<link href="libraries/jquery-ui-1.11.4.custom/jquery-ui.min.css">
	<link href ="libraries/jquery-ui-1.11.4.custom/jquery-ui.structure.css">
	<link href="libraries/jquery-ui-1.11.4.custom/jquery-ui.structure.min.css">
	<link href="libraries/jquery-ui-1.11.4.custom/jquery-ui.theme.css">
	<link href="libraries/jquery-ui-1.11.4.custom/jquery-ui.theme.min.css">

</head>
<script src="libraries/jquery-1.12.2.js"></script>
<script src="libraries/victor-1.1.0/build/victor.js"></script>
<script src="libraries/jquery-ui-1.11.4.custom/jquery-ui.js"></script>

<body>
	<canvas id = "canvas"> </canvas>
	<button id="plantButton">Plant</button>
	<button id="waterButton">Water</button>
</body>

<script>
!function(){
	'use strict'
	var count = 2;
	var canvas;
	var ctx;
	var audioCtx;
	var plant = true;
	var water = false;
	
	
	var pot1 = false;
	var pot2 = false;
	var pot3 = false;
	
	var plant1 = 0;
	var plant2 = 0;
	
	var click = true;
	var click2 = true;
	
	var j = 0;
	var p = 0;
	
	var lastPos;
	var lastPos2;
	
	var vec2 = Victor;
	

	
	$("button").button();
	
	$('#plantButton')
		.click(function(){
			plant = true;
			water = false;
			//console.log(plant);
	});
	$('#waterButton')
		.click(function(){
			plant = false;
			water = true;
			//console.log(plant);
	});
	
	
	
	function setup(){
		canvas = document.getElementById("canvas");
		ctx = canvas.getContext("2d");
		canvas.setAttribute("width",window.innerWidth-16);
		canvas.setAttribute("height",window.innerHeight - 100);
		audioCtx = new AudioContext();
		
		ctx.fillStyle = "black";
		ctx.fillRect(0,0,canvas.width,canvas.height);
		
		ctx.fillStyle = "red";
		ctx.fillRect(canvas.width/6+70, canvas.height-60, 50,50);
		ctx.fillRect(canvas.width - canvas.width/1.8 + 70, canvas.height-60, 50,50);
		ctx.fillRect(canvas.width - canvas.width/4 + 70, canvas.height-60, 50,50);
		
		ctx.fillStyle = "#FEFCD7";
		ctx.beginPath();
		ctx.arc(100,75,50,0,2*Math.PI);
		ctx.stroke();
		ctx.fill();
		
		
		lastPos = vec2(canvas.width/6+94,canvas.height-50);
		lastPos2 = vec2(canvas.width - canvas.width/1.8 + 94,canvas.height-50);

		
	}
	setup();
	
	window.Turtle = function(canvas,startX,startY){
		Object.assign(this, {
			canvas:null,
			weight:1,
			color:'red',
			pos: vec2(startX,startY),
			dir: vec2(0,-1),
			pen:1,
			posArray:[],
			dirArray:[],
			penUp : function() {this.pen = 0},
			penDown: function() {this.pen = 1},
			
			push: function(){
				this.posArray.push (this.pos.clone())
				this.dirArray.push(this.dir.clone())
			},
			
			pop: function() {
				this.pos = this.posArray.pop()
				this.dir = this.dirArray.pop()
				this.canvas.moveTo(this.pos.x,this.pos.y)
			},
			
			//THIS IS IN RADIANS!!!
			rotate: function(amt){
				this.dir.rotate(amt)
			},
			
			move: function(amt){
				if(this.pen) this.canvas.beginPath()
				this.canvas.moveTo(this.pos.x,this.pos.y)
				
				this.pos.x += this.dir.x * amt
				this.pos.y += this.dir.y * amt
				
				if(this.pen){
					this.canvas.lineTo(this.pos.x,this.pos.y)
					this.canvas.lineWidth = this.weight
					this.canvas.stroke()
					this.canvas.closePath()
				}
				else{
					this.moveTo(this.pos.x,this.pos.y)
				}
			},
		})
		this.canvas = canvas
		this.canvas.moveTo(this.pos.x,this.pos.y)
	}
	
	
	var degToRad = function( deg ) {
      return deg * Math.PI / 180
    }
	
	
	//plant 1 rules
	window.xavier = new Turtle(ctx, 250,window.innerHeight);
	var string = "F";
	var newString = "";
	function rules(){
		newString = "";
		for(var i = 0; i < string.length; i++)
		{
			if(string.charAt(i) == 'F')
			{
				newString += "F[+FF]F[-FF][FF]";
			}	
			else
			{
				newString += string.charAt(i);
			}	
		}
		
		string = newString;
	}
	
	var thetaDeg = 20;
	var theta = 2;
	
		
	theta = degToRad(thetaDeg);
		

	var time = 0;
	var timeDeg;
	var right = true;
	
	var mousex;
	var mousey;
	var event;
	
	

	canvas.onmousedown = function(event){
		mousex = event.x;
  		mousey = event.y;

  		getMousePosition();
  		console.log("xavier: " + xavier.pos + " Jade " + jade.pos);
	}
	
	
	function getMousePosition(event){
		//console.log("X: " + mousex + " Y: " + mousey);
		
		//1st pot
		if((mousex >= canvas.width/6+78) & (mousex < canvas.width/6 + 78 + 50)
		&& (mousey >= canvas.height-49) && (mousey < canvas.height-49 + 50)){
				pot1 = true;
				pot2 = false;
				pot3 = false;
				//console.log("Pot1: " + pot1 + " Pot2: " + pot2 + " Pot3: " + pot3);
				if(plant1 < 3 && click == true){
					plant1++;
					//console.log("Plant num: " + plant1);
					drawCorrect();
				}
				
		}
		
		//2nd pot
		if((mousex >= canvas.width - canvas.width/1.8 + 78) && (mousex < canvas.width - canvas.width/1.8 + 78 + 50)
		&& (mousey >= canvas.height-49) && (mousey < canvas.height-49 + 50)){
				pot1 = false;
				pot2 = true;
				pot3 = false;
				//console.log("Pot1: " + pot1 + " Pot2: " + pot2 + " Pot3: " + pot3);
				if(plant2 < 3 && click2 == true){
					plant2++;
					//console.log("Plant num: " + plant2);
					drawCorrect2();
					console.log("I drew plant 2");
				}
		}
		//3rd pot
		if((mousex >= canvas.width - canvas.width/4 + 78) && (mousex < canvas.width - canvas.width/4 + 78 + 50)
		&& (mousey >= canvas.height-49) && (mousey < canvas.height-49 + 50)){
				pot1 = false;
				pot2 = false;
				pot3 = true;
				//console.log("Pot1: " + pot1 + " Pot2: " + pot2 + " Pot3: " + pot3);
		}
	}
	
		

	
	function draw(){	
		
		xavier.pos = lastPos;
		//console.log("xavier: " + xavier.pos);
		//console.log("Last: " +lastPos);
		ctx.fillStyle = "green";		

		
		ctx.save();
		timeDeg = degToRad(time);
		ctx.translate(0,0);
		ctx.rotate(timeDeg);
		
		//console.log(string.length);
		
		                    
		
		function myLoop () {           
			setTimeout(function () {    
				if(string.charAt(j) =='F')
				{
					ctx.strokeStyle = 'rgb(' + (Math.floor(Math.random() * 256)) + ',' + (Math.floor(Math.random() 
					* 256)) + ',' + (Math.floor(Math.random() * 256)) + ')';
					xavier.move(15)
				}
				else if(string.charAt(j) =='+')
				{
	
					xavier.rotate(-theta);
				}
				else if(string.charAt(j) == '-')
				{
					xavier.rotate(theta);
				}
				else if(string.charAt(j) == '[')
				{
					xavier.push(xavier.pos.clone());
				}
				else if(string.charAt(j) == ']')
				{
					xavier.pop();
				}  
				       
				j++;                   
				if (j < string.length) {          
					myLoop();
					click = false;
				}
				if(j == string.length){
					click = true;
				}
			}, 5)
			lastPos = xavier.pos;
		}

		myLoop(); 

		
		ctx.restore();
	}
	
	
	
	function drawCorrect(){
		for(var k = 0; k < plant1; k++){
			rules();
		}
		draw();
	}
	
	
	
	
	
	
	
	
	//plant 2 stuff
	window.jade = new Turtle(ctx, 250,window.innerHeight);
	var string2 = "F";
	var newString2 = "";
	function rules2(){
		newString2 = "";
		for(var i = 0; i < string2.length; i++)
		{
			if(string2.charAt(i) == 'F')
			{
				newString2 += "F[F-F]F[+F]F";
			}	
			else
			{
				newString2 += string2.charAt(i);
			}	
			
		}
		string2 = newString2;
	}
	
	function draw2(){	
		console.log("String is: " + string2);
		jade.pos = lastPos2;
		//console.log("jade: " + jade.pos);
		//console.log("Last: " +lastPos2);
		ctx.fillStyle = "green";		

		
		ctx.save();
		timeDeg = degToRad(time);
		ctx.translate(0,0);
		ctx.rotate(timeDeg);
		
		//console.log(string2.length);
		
		                    
		
		function myLoop2 () {           
			setTimeout(function () {    
				if(string2.charAt(p) =='F')
				{
					ctx.strokeStyle = 'rgb(' + (Math.floor(Math.random() * 256)) + ',' + (Math.floor(Math.random() 
					* 256)) + ',' + (Math.floor(Math.random() * 256)) + ')';
					jade.move(15)
				}
				else if(string2.charAt(p) =='+')
				{
	
					jade.rotate(-theta);
				}
				else if(string2.charAt(p) == '-')
				{
					jade.rotate(theta);
				}
				else if(string2.charAt(p) == '[')
				{
					jade.push(jade.pos.clone());
				}
				else if(string2.charAt(p) == ']')
				{
					jade.pop();
				}  
				       
				p++;                   
				if (p < string2.length) {          
					myLoop2();
					click2 = false;
				}
				if(p == string2.length){
					click2 = true;
				}
			}, 5)
			lastPos2 = jade.pos;
		}

		myLoop2(); 

		
		ctx.restore();
	}
	
	
	function drawCorrect2(){
		for(var k = 0; k < plant2; k++){
			rules2();
		}
		draw2();
	}
	


}()

  </script>

</html>
